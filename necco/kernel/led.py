import pyvga
import rtc
import blit

horz = "\020\020\020\020\020\020\022\027\030\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\032\020\020\020\020\020\020\020\020\020\020\020\027\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\020\020\020\020\020\020\020\030\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\033\020\020\020\020\020\020\030\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\033\020\020\020\020\026\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\020\020\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\020\026\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\030\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\033\020\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\020\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\020\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\030\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\033\020\026\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\020\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\020\020\026\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\020\020\020\030\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\033\020\020\020\020\020\020\030\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\033\020\020\020\020\020\020\020\020\027\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\020\020\020\020\020\020\020\020\020\022\026\030\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\032\020\020\020\020\020\020"
vert = "\020\020\020\020\020\020\032\033\032\067\067\032\033\032\020\020\020\020\020\020\020\020\020\020\032\032\067\067\067\067\067\067\067\067\032\032\020\020\020\020\020\020\020\033\067\067\067\067\067\067\067\067\067\067\067\067\033\020\020\020\020\020\033\067\067\067\067\067\067\067\067\067\067\067\067\067\067\033\020\020\020\032\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\020\020\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\020\032\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\032\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\032\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\030\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\030\027\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\026\022\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\022\020\027\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\067\027\020\020\020\030\067\067\067\067\067\067\067\067\067\067\067\067\067\067\030\020\020\020\020\020\030\067\067\067\067\067\067\067\067\067\067\067\067\030\020\020\020\020\020\020\020\026\067\067\067\067\067\067\067\067\067\067\026\020\020\020\020\020\020\020\020\020\020\026\030\067\067\067\067\030\026\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020\020"

########################################

def seven_segment(n):
	if ord("\01\00\01\01\00\01\01\01\01\01\01\00\01\00\01\01"[n]):	v = 55
	else:								v = 0
	if v: blit.paste(pyvga.framebuffer,320, 140, 30, horz, 40)
	else: blit.fill(pyvga.framebuffer,320, 140, 30, 40, 20, v)

	if ord("\01\00\00\00\01\01\01\00\01\01\00\01\01\00\01\01"[n]):	v = 55
	else:								v = 0
	if v: blit.paste(pyvga.framebuffer,320, 130, 50, vert, 20)
	else: blit.fill(pyvga.framebuffer,320, 130, 50, 20, 40, v)

	if ord("\01\01\01\01\01\00\00\01\01\01\01\00\00\01\00\00"[n]):	v = 55
	else:								v = 0
	if v: blit.paste(pyvga.framebuffer,320, 170, 50, vert, 20)
	else: blit.fill(pyvga.framebuffer,320, 170, 50, 20, 40, v)

	if ord("\00\00\01\01\01\01\01\00\01\01\01\01\00\01\01\01"[n]):	v = 55
	else:								v = 0
	if v: blit.paste(pyvga.framebuffer,320, 140, 90, horz, 40)
	else: blit.fill(pyvga.framebuffer,320, 140, 90, 40, 20, v)

	if ord("\01\00\01\00\00\00\01\00\01\00\01\01\01\01\01\01"[n]):	v = 55
	else:								v = 0
	if v: blit.paste(pyvga.framebuffer,320, 130, 110, vert, 20)
	else: blit.fill(pyvga.framebuffer,320, 130,110, 20, 40, v)

	if ord("\01\01\00\01\01\01\01\01\01\01\01\01\00\01\00\00"[n]):	v = 55
	else:								v = 0
	if v: blit.paste(pyvga.framebuffer,320, 170, 110, vert, 20)
	else: blit.fill(pyvga.framebuffer,320, 170,110, 20, 40, v)

	if ord("\01\00\01\01\00\01\01\00\01\00\01\01\01\01\01\00"[n]):	v = 55
	else:								v = 0
	if v: blit.paste(pyvga.framebuffer,320, 140, 150, horz, 40)
	else: blit.fill(pyvga.framebuffer,320, 140,150, 40, 20, v)

########################################

import isr
import ports

def key_isr():
	ports.outb(0xfe,0x64)	# reboot!
	
def clk_isr():
	if isr.ticker > 50:
		seven_segment(rtc.seconds() & 0xF)

########################################

pyvga.set320x200x256()
pyvga.framebuffer[:0xFA00] = pyvga.splashscreen[:0xFA00]

isr.setvec(clk_isr, key_isr)

while isr.ticker < 40:
	pass
blit.fill(pyvga.framebuffer,320,0,0,320,200,0)
while 1:
	pass
